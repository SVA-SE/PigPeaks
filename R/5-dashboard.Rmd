---
title: "PigPeaks Dashboard"
output:
  flexdashboard::flex_dashboard:
    theme: simplex
    vertical_layout: scroll
    social: menu
    orientation: rows
    df_print: paged
  # logo: SVA_logo.png
---

<style type="text/css">

.chart-title {  /* chart_title  */
   font-size: 15px;
}
    
</style>

```{r message=FALSE, warning=FALSE}
library(flexdashboard)
require(RColorBrewer)
library(plotly)
library(ggplot2)
library(stringr)


setwd('..') #do not run this line if running manually (instead of knitting)

source('Settings.r') 
source('R/Functions.r') 
source('R/Functions-plotting.r')
source('R/4-detection.R')
load('data/individual.sows.RData')
load('data/indicators.RData')

```


```{r}

chose.arguments.plot <- function(i = index
){
  
indicator.label = "indicator"
ylabel = indicators.labels[i]

if (isTRUE(indicators.sys[i])) {
  
  vertical.line = NULL
  vertical.line.label=NULL
  shading.matrix = NULL
  limits = NULL
  series.line = NULL
  group.labels=c('gilts','young','prime','mature')
  y2label = '% of'
  y2range = c(0,1)
  
  if (indicators.limits[i]=="limit.upp") {
    
    UCL.EWMA = TRUE
    LCL.EWMA = FALSE
    UCL.SHEW = TRUE
    LCL.SHEW = FALSE
    alarms.EWMA.UPP = TRUE
    alarms.EWMA.LW = FALSE
    alarms.SHEW.UPP = TRUE
    alarms.SHEW.LW = FALSE
    
  }
  if (indicators.limits[i]=="both") {
    
    UCL.EWMA = TRUE
    LCL.EWMA = TRUE
    UCL.SHEW = FALSE
    LCL.SHEW = FALSE
    alarms.EWMA.UPP = TRUE
    alarms.EWMA.LW = TRUE
    alarms.SHEW.UPP = TRUE
    alarms.SHEW.LW = TRUE
  }
  
  if (indicators.limits[i]=="limit.lw") {
    
    UCL.EWMA = FALSE
    LCL.EWMA = TRUE
    UCL.SHEW = FALSE
    LCL.SHEW = TRUE
    alarms.EWMA.UPP = FALSE
    alarms.EWMA.LW = TRUE
    alarms.SHEW.UPP = FALSE
    alarms.SHEW.LW = TRUE
  }
  
}
if (isFALSE(indicators.sys[i])) {
  
  vertical.line = NULL
  vertical.line.label = NULL
  shading.matrix = NULL
  limits = NULL
  series.line = NULL
  group.labels=c('gilts','young','prime','mature')
  y2label = '% of'
  y2range = c(0,1)
  UCL.EWMA = FALSE
  LCL.EWMA = FALSE
  UCL.SHEW = FALSE
  LCL.SHEW = FALSE
  alarms.EWMA.UPP = FALSE
  alarms.EWMA.LW = FALSE
  alarms.SHEW.UPP = FALSE
  alarms.SHEW.LW = FALSE
  
}

if (indicators.type[i]=="W") {
  
  show.window = weeks.to.show
  index.dates = index.dates.week
  xlabel = 'Week'
  
}

if (indicators.type[i]=="C") {
  
  show.window = nonTS.to.show
  index.dates = index.dates.days
  xlabel = 'Events'
  
}

arguments <- list(indicator.label=indicator.label, ylabel=ylabel, vertical.line=vertical.line,
                  vertical.line.label=vertical.line.label, shading.matrix=shading.matrix,
                  limits=limits, series.line=series.line, group.labels=group.labels, UCL.EWMA=UCL.EWMA,
                  LCL.EWMA=LCL.EWMA, UCL.SHEW=UCL.SHEW, LCL.SHEW=LCL.SHEW,
                  alarms.EWMA.UPP=alarms.EWMA.UPP, alarms.EWMA.LW=alarms.EWMA.LW,
                  alarms.SHEW.UPP=alarms.SHEW.UPP, alarms.SHEW.LW=alarms.SHEW.LW,
                  show.window=show.window, index.dates=index.dates, xlabel=xlabel, 
                  y2label=y2label, y2range=y2range)


return(arguments)
}
  
```


Gilts
====================================

Row
-------------------------------------

### Time to first service

```{r}

if("time.to.first.service" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="time.to.first.service")])) {
  
  i = which(names(indicators.data)=="time.to.first.service")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### Time to first farrowing

```{r}

if("time.to.first.farrowing" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="time.to.first.farrowing")])) {
  
  i = which(names(indicators.data)=="time.to.first.farrowing")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}

```


Empty Sows
====================================

Row
-------------------------------------

### Sows empty longer than target, weekly

```{r}

if("empty.long.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="empty.long.week")])) {
  
  i = which(names(indicators.data)=="empty.long.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```


Services
====================================

Row
-------------------------------------

### Services per week

```{r}

if("services.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="services.week")])) {
  
  i = which(names(indicators.data)=="services.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```


Row
-------------------------------------

### Reservices per week

```{r}

if("reservices.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="reservices.week")])) {
  
  i = which(names(indicators.data)=="reservices.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}

```

Row
-------------------------------------

### Time to reservice

```{r}

if("time.to.reservice" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="time.to.reservice")])) {
  
  i = which(names(indicators.data)=="time.to.reservice")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
  
}

```

Row
-------------------------------------

### Sows re-serviced twice

```{r}

if("rereservices" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="rereservices")])) {
  
  i = which(names(indicators.data)=="rereservices")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
  
  #cat("### Sows re-serviced twice")
}

```

Row
-------------------------------------

### % failure, weekly

```{r}

if("perc.failure" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.failure")])) {
  
  i = which(names(indicators.data)=="perc.failure")
  
    TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                  argument.list = TRUE,
                  target = NULL,
                  target.unit = NULL)
}

```

Row
-------------------------------------

### % reservice, weekly

```{r}

if("perc.reservice" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.reservice")])) {
  
  i = which(names(indicators.data)=="perc.reservice")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}

```


Pregnancy
====================================

Row
-------------------------------------

### % pregnancy, weekly

```{r}

if("perc.pregnancy" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.pregnancy")])) {
  
  i = which(names(indicators.data)=="perc.pregnancy")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### Abortions per week

```{r}

if("abortions.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="abortions.week")])) {
  
  i = which(names(indicators.data)=="abortions.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### Time to abortion

```{r}

if("time.to.abortion" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="time.to.abortion")])) {
  
  i = which(names(indicators.data)=="time.to.abortion")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```


Row
-------------------------------------

### services to farrow

```{r}

if("services.to.farrow" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="services.to.farrow")])) {
  
  i = which(names(indicators.data)=="services.to.farrow")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### Pregnancy length

```{r}

if("pregnancy.length" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="pregnancy.length")])) {
  
  i = which(names(indicators.data)=="pregnancy.length")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```


Farrowing
====================================

Row
-------------------------------------

### Days between farrowings

```{r}

if("days.between.farrowings" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="days.between.farrowings")])) {
  
  i = which(names(indicators.data)=="days.between.farrowings")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### farrowings per week

```{r}

if("farrowings.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="farrowings.week")])) {
  
  i = which(names(indicators.data)=="farrowings.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### total born per week

```{r}
if("total.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="total.born.week")])) {
  
  i = which(names(indicators.data)=="total.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}

```

Row
-------------------------------------

### live born per week

```{r}

if("live.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="live.born.week")])) {
  
  i = which(names(indicators.data)=="live.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### dead born per week

```{r}

if("dead.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="dead.born.week")])) {
  
  i = which(names(indicators.data)=="dead.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### small born per week

```{r}

if("small.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="small.born.week")])) {
  
  i = which(names(indicators.data)=="small.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### weak born per week

```{r}

if("weak.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="weak.born.week")])) {
  
  i = which(names(indicators.data)=="weak.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### mummified born per week

```{r}

if("mummi.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="mummi.born.week")])) {
  
  i = which(names(indicators.data)=="mummi.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### % born dead, weekly

```{r}

if("perc.dead.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.dead.born.week")])) {
  
  i = which(names(indicators.data)=="perc.dead.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### % small born, weekly

```{r}

if("perc.small.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.small.born.week")])) {
  
  i = which(names(indicators.data)=="perc.small.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### % weak born, weekly

```{r}

if("perc.weak.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.weak.born.week")])) {
  
  i = which(names(indicators.data)=="perc.weak.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### % mummified, weekly

```{r}

if("perc.mummi.born.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.mummi.born.week")])) {
  
  i = which(names(indicators.data)=="perc.mummi.born.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### piglets per farrowing

```{r}

if("total.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="total.born.litter")])) {
  
  i = which(names(indicators.data)=="total.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### live born per farrowing

```{r}

if("live.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="live.born.litter")])) {
  
  i = which(names(indicators.data)=="live.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### dead born per farrowing

```{r}

if("dead.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="dead.born.litter")])) {
  
  i = which(names(indicators.data)=="dead.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### % dead born per farrowing

```{r}

if("perc.dead.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.dead.born.litter")])) {
  
  i = which(names(indicators.data)=="perc.dead.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### small born per farrowing

```{r}

if("small.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="small.born.litter")])) {
  
  i = which(names(indicators.data)=="small.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### % small born per farrowing

```{r}

if("perc.small.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.small.born.litter")])) {
  
  i = which(names(indicators.data)=="perc.small.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### weak born per farrowing

```{r}

if("weak.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="weak.born.litter")])) {
  
  i = which(names(indicators.data)=="weak.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### % weak born per farrowing

```{r}

if("perc.weak.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.weak.born.litter")])) {
  
  i = which(names(indicators.data)=="perc.weak.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### mummified per farrowing

```{r}

if("mummi.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="mummi.born.litter")])) {
  
  i = which(names(indicators.data)=="mummi.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### % mummified per farrowing

```{r}

if("perc.mummi.born.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.mummi.born.litter")])) {
  
  i = which(names(indicators.data)=="perc.mummi.born.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```


Weaning
====================================

Row
-------------------------------------

### Weanings per week

```{r}

if("weanings.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="weanings.week")])) {
  
  i = which(names(indicators.data)=="weanings.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### piglets weaned per week

```{r}

if("total.wean.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="total.wean.week")])) {
  
  i = which(names(indicators.data)=="total.wean.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### weaned-expected weaned per week

```{r}

if("diff.wean.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="diff.wean.week")])) {
  
  i = which(names(indicators.data)=="diff.wean.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### expected-weaned weaned per week

```{r}

if("negdiff.wean.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="negdiff.wean.week")])) {
  
  i = which(names(indicators.data)=="negdiff.wean.week")
    
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}
```

Row
-------------------------------------

### days to weaning

```{r}

if("weaning.length" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="weaning.length")])) {
  
  i = which(names(indicators.data)=="weaning.length")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```


Row
-------------------------------------

### piglets weaned per weaning

```{r}

if("total.wean.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="total.wean.litter")])) {
  
  i = which(names(indicators.data)=="total.wean.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### weaned-expected weaned per weaning

```{r}

if("negdiff.weaned.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="negdiff.weaned.litter")])) {
  
  i = which(names(indicators.data)=="negdiff.weaned.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### % weaned-expected weaned per weaning

```{r}

if("perc.negdiff.weaned.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="perc.negdiff.weaned.litter")])) {
  
  i = which(names(indicators.data)=="perc.negdiff.weaned.litter")

    nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```

Row
-------------------------------------

### average weight at weaning

```{r}

if("weight.wean.litter" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="weight.wean.litter")])) {
  
  i = which(names(indicators.data)=="weight.wean.litter")
  
  nonTS.barplot.pg.timeless(df.indicator = indicators.time.series[[i]],
                            argument.list = TRUE,
                            target = NULL,
                            target.unit = NULL,                     
                            use.minimum.y = "min",                     
                            barmode = 'group')
}
```


Post-Weaning
====================================

Row
-------------------------------------

### weaned piglet deaths per week

```{r}

if("piglets.deaths.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="piglets.deaths.week")])) {
  
  i = which(names(indicators.data)=="piglets.deaths.week")
  
  TS.barplot(df.indicator = indicators.time.series[[i]],
             argument.list = TRUE,
             target = NULL,
             target.unit = NULL, 
             series.label = "piglets")
}

```


Exit
====================================

Row
-------------------------------------

### sow deaths per week

```{r}

if("number.deaths.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="number.deaths.week")])) {
  
  i = which(names(indicators.data)=="number.deaths.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}

```

Row
-------------------------------------

### gilt deaths per week

```{r}

if("gilts.deaths.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="gilts.deaths.week")])) {
  
  i = which(names(indicators.data)=="gilts.deaths.week")

  TS.barplot(df.indicator = indicators.time.series[[i]],
             argument.list = TRUE,
             target = NULL,
             target.unit = NULL, 
             series.label = "gilts")
}

```

Row
-------------------------------------

### number of exits per week

```{r}

if("number.exits.week" %in% names(indicators.data) && isTRUE(indicators.sys[which(names(indicators.data)=="number.exits.week")])) {
  
  i = which(names(indicators.data)=="number.exits.week")
  
  TS.barplot.pg(df.indicator = indicators.time.series[[i]],
                argument.list = TRUE,
                target = NULL,
                target.unit = NULL)
}

```
